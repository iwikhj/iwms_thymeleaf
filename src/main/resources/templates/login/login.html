<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="common :: head(~{::title},~{},~{::script})">
<title>Login Page</title>
</head>
<body>
	<div>
		<form th:id="form0">
			<label>아이디</label>
			<input type="text" th:name="username"/>
			<label>비밀번호</label>
			<input type="password" th:name="password"/>
			<label>아이디 기억하기</label>
			<input type="checkbox" th:name="rememberId" th:onclick="remeberId(this);">
			<button type="button" th:onclick="login();">로그인</button>
		</form>
	</div>
	<br>
	<div>
		<button type="button" th:onclick="noticeList();">공지사항 목록</button>
		<table id="memberTable" th:fragment="memberTable">
			<thead>
				<tr>
					<th>번호</th>
					<th>SEQ</th>
					<th>소속명</th>
					<th>제목</th>
					<th>메인고정</th>
					<th>상단고정</th>
					<th>작성자</th>
					<th>작성일</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="member : ${memberList}">
				  <td th:text="${member.key}" />
				  <td th:text="${member.value}" />
				</tr>
			</tbody>
		</table>
	</div>

	<script th:inline="javascript">
	
	function remeberId(_this) {
		_this.value = _this.checked;
	}
	
	function login() {
		let form = document.getElementById("form0");
		callAjax("/login", "POST", form).then(success => {
			console.log("get success, ", success);
			localStorage.setItem("accessToken", success.data.accessToken);
		}, err => {
			console.error("get fail, ", err);
		});
	}	
	
	function noticeList() {
		callAjax("/notices").then(success => {
			console.log("get success, ", success);
			 
			document.getElementById("memberTable").innerHTML = success.data;
		}, err => {
			console.error("get fail, ", err);
		});
	}
	</script>	
</body>
</html>